functions:
  # Outer workflow nodes
  pre_process:
    _type: pre_process
    description: "Pre-processing function that initializes the SAST workflow"

  filter:
    _type: filter
    description: "Filter function that filters known false positives and retrieve similar issues"
    llm_name: main_llm
    embedder_llm_name: filter_embedding

  # Agent-based investigation (replaces old 3-iteration loop)
  investigate_issue:
    _type: investigate_issue
    description: "Agent-based investigation replacing data_fetcher → judge → evaluate loop"
    llm_name: main_llm

  summarize_justifications:
    _type: summarize_justifications
    description: "Summarize justifications function that summarizes analysis justifications"
    llm_name: main_llm

  calculate_metrics:
    _type: calculate_metrics
    description: "Calculate metrics function that calculates performance metrics for SAST analysis"

  write_results:
    _type: write_results
    description: "Write results function that writes the final SAST analysis results"

  # Agent tools (called by investigate_issue internally)
  fetch_code:
    _type: fetch_code
    description: "Fetch source code by file path or symbol name"

  analyze_issue:
    _type: analyze_issue
    description: "Perform security analysis on gathered code context"
    llm_name: main_llm

  comprehensive_evaluation:
    _type: comprehensive_evaluation
    description: "Audit investigation process and logic completeness"
    llm_name: main_llm

llms:
  main_llm:
    _type: ${LLM_API_TYPE}
    api_key: ${LLM_API_KEY}
    base_url: ${LLM_URL}
    model_name: ${LLM_MODEL_NAME}
    temperature: 0
    top_p: 1.0
    max_tokens: 4096

embedders:
  filter_embedding:
    _type: extended_openai
    api_key: ${EMBEDDINGS_LLM_API_KEY}
    base_url: ${EMBEDDINGS_LLM_URL}
    model_name: ${EMBEDDINGS_LLM_MODEL_NAME}
    tiktoken_enabled: false
    show_progress_bar: true
    http_client:
      verify: false

workflow:
  _type: sast_agent
  pre_process_function_name: pre_process
  filter_function_name: filter
  investigate_issue_function_name: investigate_issue
  summarize_justifications_function_name: summarize_justifications
  calculate_metrics_function_name: calculate_metrics
  write_results_function_name: write_results
  description: "SAST agent workflow with agent-based investigation"

general:
  use_uvloop: true
  logging:
    console:
      _type: console
      level: INFO
  front_end:
    type: console
