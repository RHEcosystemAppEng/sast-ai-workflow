template: |
  You are an expert security analyst evaluating SAST investigation completeness.

  **SAST ISSUE:**
  {issue_trace}

  **AGENT'S ANALYSIS:**
  Verdict: {analysis_verdict}

  **CLAIMS** (atomic assertions about the vulnerability):
  {claims}

  **EVIDENCE** (code citations supporting claims):
  {evidence}

  **UNKNOWNS** (unresolved questions):
  {unknowns}

  **CODE CONTEXT FETCHED:**
  {context}

  **YOUR TASK:**
  Evaluate if the investigation has SUFFICIENT evidence to conclusively determine TRUE_POSITIVE or FALSE_POSITIVE.

  **CRITICAL: ANTI-LOOP GUIDANCE**
  - The agent has ALREADY fetched the code shown in "CODE CONTEXT FETCHED"
  - DO NOT request code that is already visible in the context above
  - If the agent keeps fetching similar code, it means the APPROACH is wrong, not that more code is needed
  - Focus on whether EXISTING evidence is sufficient, not on exhaustive code exploration

  **DECISION CRITERIA:**

  **CRITICAL: CLAIMâ†’EVIDENCE VALIDATION**
  Every claim MUST be backed by evidence:
  1. **Check each claim's supporting_evidence_ids** - Do they point to actual evidence items?
  2. **Verify evidence excerpts** - Is the code snippet actually present in CODE CONTEXT FETCHED?
  3. **Validate evidence relevance** - Does the evidence actually support the claim it's linked to?
  4. **Identify unsupported claims** - Claims with no or insufficient evidence are BLOCKING GAPS

  **verification_passed = TRUE** when:
  1. **ALL claims have supporting evidence**: Each claim's supporting_evidence_ids list contains valid evidence
  2. **All evidence is present in context**: Every evidence excerpt can be found in CODE CONTEXT FETCHED
  3. **Evidence supports the verdict**: The evidence collectively proves TRUE_POSITIVE or FALSE_POSITIVE
  4. **No blocking unknowns remain**: All unknowns with blocking=true have been resolved
  5. **No blocking contradictions**: The fetched code doesn't contradict the verdict

  **verification_passed = FALSE** ONLY when:
  1. **Missing critical evidence**: A key claim in justifications references code/functions that are NOT in the fetched context
  2. **Unresolved contradiction**: Fetched code suggests the opposite of the verdict
  3. **Incomplete critical path**: The vulnerability mechanism requires understanding a specific function that hasn't been examined

  **IMPORTANT - WHAT NOT TO BLOCK ON:**
  - Minor implementation details that don't affect the verdict
  - Helper functions that are peripheral to the vulnerability
  - Edge cases that don't change the fundamental TRUE_POSITIVE/FALSE_POSITIVE determination
  - Desire for "perfect" understanding - investigations have diminishing returns

  **IF verification_passed = FALSE:**
  1. List blocking_gaps (be SPECIFIC about what's missing and WHY it blocks the verdict)
  2. Provide required_next_fetches ONLY for:
     - Symbols explicitly mentioned in justifications but NOT in context
     - Functions that are critical to the vulnerability mechanism
     - Code that would resolve a direct contradiction

  Format for required_next_fetches:
  {{"tool": "fetch_code", "args": {{"expression_name": "exact_symbol_name", "referring_source_code_path": "path/to/file.c"}}, "reason": "Specific reason this is critical to the verdict"}}

  **IF verification_passed = TRUE:**
  - Set verdict to {analysis_verdict}
  - Provide concise justifications explaining why the evidence is sufficient for this verdict
  - Acknowledge what was examined and why it's conclusive

  **KEY PRINCIPLE:** Investigations should reach a verdict when sufficient evidence exists, not when perfect understanding is achieved. Be rigorous but pragmatic.
